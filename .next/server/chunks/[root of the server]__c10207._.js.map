{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 63, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new/my-app/src/app/lib/database.js"],"sourcesContent":["// src\\app\\utils\\database.js\r\nimport mongoose from \"mongoose\";\r\n\r\nconst connectToDatabase = async () => {\r\n    if (mongoose.connection.readyState >= 1) return;\r\n    \r\n    await mongoose.connect(process.env.MONGO_URI, {\r\n        useNewUrlParser: true,\r\n        useUnifiedTopology: true,\r\n    });\r\n\r\n    console.log(\"Database connected!\");\r\n};\r\n\r\n// ✅ Make sure we export it correctly\r\nexport { connectToDatabase };\r\n\r\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;AAC5B;;AAEA,MAAM,oBAAoB;IACtB,IAAI,yGAAA,CAAA,UAAQ,CAAC,UAAU,CAAC,UAAU,IAAI,GAAG;IAEzC,MAAM,yGAAA,CAAA,UAAQ,CAAC,OAAO,CAAC,QAAQ,GAAG,CAAC,SAAS,EAAE;QAC1C,iBAAiB;QACjB,oBAAoB;IACxB;IAEA,QAAQ,GAAG,CAAC;AAChB"}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new/my-app/src/app/models/session.js"],"sourcesContent":["// src\\app\\models\\session.js\r\nconst mongoose = require(\"mongoose\");\r\nconst sessionSchema = new mongoose.Schema({\r\n  // id: { type: String, unique: false }, // UNIQUE REMOVE KAR DIYA\r\n  state: { type: String },\r\n  shop: { type: String, trim: true, unique: true }, // Shop unique rahega\r\n  accessToken: { type: String, trim: true },\r\n  isOnline: { type: Boolean, enum: [true, false], default: false },\r\n  scope: { type: [String], default: [] },\r\n  isInstalled: { type: Boolean, default: true }, // Track installation state\r\n  uninstalledAt: { type: Date, default: null },  // Track uninstall timestamp\r\n});\r\nconst Session = mongoose.models.Session || mongoose.model(\"Session\", sessionSchema);\r\nexport default Session;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// const mongoose = require(\"mongoose\");\r\n// const sessionSchema = new mongoose.Schema({\r\n//     id: {\r\n//         type: String,\r\n//     },\r\n//     state: {\r\n//         type: String,\r\n//     },\r\n//     shop: {\r\n//         type: String,\r\n//         trim: true,\r\n//     },\r\n//     accessToken: {\r\n//         type: String,\r\n//         trim: true,\r\n//     },\r\n//     isOnline: {\r\n//         type: Boolean,\r\n//         enum: [true, false],\r\n//         default: false,\r\n//     },\r\n//     scope: {\r\n//         type: [String],\r\n//         default: [],\r\n//     },\r\n// });\r\n// // Check if the model already exists to prevent OverwriteModelError\r\n// const Session = mongoose.models.Session || mongoose.model(\"Session\", sessionSchema);\r\n// export default Session;"],"names":[],"mappings":"AAAA,4BAA4B;;;;AAC5B,MAAM;AACN,MAAM,gBAAgB,IAAI,SAAS,MAAM,CAAC;IACxC,iEAAiE;IACjE,OAAO;QAAE,MAAM;IAAO;IACtB,MAAM;QAAE,MAAM;QAAQ,MAAM;QAAM,QAAQ;IAAK;IAC/C,aAAa;QAAE,MAAM;QAAQ,MAAM;IAAK;IACxC,UAAU;QAAE,MAAM;QAAS,MAAM;YAAC;YAAM;SAAM;QAAE,SAAS;IAAM;IAC/D,OAAO;QAAE,MAAM;YAAC;SAAO;QAAE,SAAS,EAAE;IAAC;IACrC,aAAa;QAAE,MAAM;QAAS,SAAS;IAAK;IAC5C,eAAe;QAAE,MAAM;QAAM,SAAS;IAAK;AAC7C;AACA,MAAM,UAAU,SAAS,MAAM,CAAC,OAAO,IAAI,SAAS,KAAK,CAAC,WAAW;uCACtD;CAQf,wCAAwC;CACxC,8CAA8C;CAC9C,YAAY;CACZ,wBAAwB;CACxB,SAAS;CACT,eAAe;CACf,wBAAwB;CACxB,SAAS;CACT,cAAc;CACd,wBAAwB;CACxB,sBAAsB;CACtB,SAAS;CACT,qBAAqB;CACrB,wBAAwB;CACxB,sBAAsB;CACtB,SAAS;CACT,kBAAkB;CAClB,yBAAyB;CACzB,+BAA+B;CAC/B,0BAA0B;CAC1B,SAAS;CACT,eAAe;CACf,0BAA0B;CAC1B,uBAAuB;CACvB,SAAS;CACT,MAAM;CACN,sEAAsE;CACtE,uFAAuF;CACvF,0BAA0B"}},
    {"offset": {"line": 157, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 163, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new/my-app/src/app/api/products/route.js"],"sourcesContent":["// src/app/api/products/route.js\r\nimport { NextResponse } from \"next/server\";\r\nimport { connectToDatabase } from \"@/app/lib/database\";\r\nimport ShopModel from \"@/app/models/session\";\r\n\r\nexport async function GET(req) {\r\n    try {\r\n        console.log(\"Received request for products...\"); // ✅ Debugging\r\n        await connectToDatabase();\r\n\r\n        const shop = req.nextUrl.searchParams.get(\"shop\");\r\n        console.log(\"Shop from request:\", shop); // ✅ Debugging\r\n\r\n        if (!shop) {\r\n            console.error(\"Error: Shop not provided\");\r\n            return NextResponse.json({ error: \"Shop not found\" }, { status: 400 });\r\n        }\r\n\r\n        const shopData = await ShopModel.findOne({ shop });\r\n        console.log(\"Shop data from MongoDB:\", shopData); // ✅ Debugging\r\n\r\n        if (!shopData) {\r\n            console.error(\"Error: Shop not registered\");\r\n            return NextResponse.json({ error: \"Shop not registered\" }, { status: 403 });\r\n        }\r\n\r\n        const accessToken = shopData.accessToken;\r\n        console.log(\"Using Access Token:\", accessToken); // ✅ Debugging\r\n\r\n        const response = await fetch(\r\n            `https://${shop}/admin/api/2025-01/products.json`, \r\n            {\r\n                method: \"GET\",\r\n                headers: {\r\n                    \"X-Shopify-Access-Token\": accessToken,\r\n                    \"Content-Type\": \"application/json\",\r\n                },\r\n            }\r\n        );\r\n\r\n        if (!response.ok) {\r\n            const errorText = await response.text();\r\n            console.error(\"Shopify API Error:\", errorText);\r\n            throw new Error(`Failed to fetch products: ${response.statusText}`);\r\n        }\r\n\r\n        const { products } = await response.json();\r\n        console.log(\"Products fetched:\", products.length); // ✅ Debugging\r\n\r\n        return NextResponse.json({ products }, { status: 200 });\r\n    } catch (error) {\r\n        console.error(\"Server Error:\", error);\r\n        return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n}\r\n\r\n\r\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;AAChC;AACA;AACA;;;;AAEO,eAAe,IAAI,GAAG;IACzB,IAAI;QACA,QAAQ,GAAG,CAAC,qCAAqC,cAAc;QAC/D,MAAM,CAAA,GAAA,+HAAA,CAAA,oBAAiB,AAAD;QAEtB,MAAM,OAAO,IAAI,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC;QAC1C,QAAQ,GAAG,CAAC,sBAAsB,OAAO,cAAc;QAEvD,IAAI,CAAC,MAAM;YACP,QAAQ,KAAK,CAAC;YACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAiB,GAAG;gBAAE,QAAQ;YAAI;QACxE;QAEA,MAAM,WAAW,MAAM,iIAAA,CAAA,UAAS,CAAC,OAAO,CAAC;YAAE;QAAK;QAChD,QAAQ,GAAG,CAAC,2BAA2B,WAAW,cAAc;QAEhE,IAAI,CAAC,UAAU;YACX,QAAQ,KAAK,CAAC;YACd,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,MAAM,cAAc,SAAS,WAAW;QACxC,QAAQ,GAAG,CAAC,uBAAuB,cAAc,cAAc;QAE/D,MAAM,WAAW,MAAM,MACnB,CAAC,QAAQ,EAAE,KAAK,gCAAgC,CAAC,EACjD;YACI,QAAQ;YACR,SAAS;gBACL,0BAA0B;gBAC1B,gBAAgB;YACpB;QACJ;QAGJ,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,YAAY,MAAM,SAAS,IAAI;YACrC,QAAQ,KAAK,CAAC,sBAAsB;YACpC,MAAM,IAAI,MAAM,CAAC,0BAA0B,EAAE,SAAS,UAAU,EAAE;QACtE;QAEA,MAAM,EAAE,QAAQ,EAAE,GAAG,MAAM,SAAS,IAAI;QACxC,QAAQ,GAAG,CAAC,qBAAqB,SAAS,MAAM,GAAG,cAAc;QAEjE,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE;QAAS,GAAG;YAAE,QAAQ;QAAI;IACzD,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,iBAAiB;QAC/B,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC,GAAG;YAAE,QAAQ;QAAI;IACrE;AACJ"}},
    {"offset": {"line": 229, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}