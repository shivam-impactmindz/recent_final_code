{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new/my-app/src/app/lib/shopify.js"],"sourcesContent":["// src\\app\\utils\\shopify.js\r\nimport { shopifyApi, ApiVersion } from \"@shopify/shopify-api\";\r\nimport \"@shopify/shopify-api/adapters/web-api\"; // ‚úÖ Required for Next.js API routes\r\nconst shopify = shopifyApi({\r\n  apiKey: process.env.NEXT_PUBLIC_SHOPIFY_API_KEY,\r\n  apiSecretKey: process.env.NEXT_PUBLIC_SHOPIFY_API_SECRET,\r\n  scopes: process.env.NEXT_PUBLIC_SHOPIFY_API_SCOPES?.split(\",\"),\r\n  apiVersion: ApiVersion.January25,\r\n  hostName: process.env.NEXT_PUBLIC_HOST.replace(/^https?:\\/\\//, \"\"), // ‚úÖ Removes \"https://\"\r\n  hostScheme: \"https\",\r\n  isEmbeddedApp: false,\r\n});\r\nexport default shopify;\r\n\r\n"],"names":[],"mappings":"AAAA,2BAA2B;;;;AAC3B;AACA,yUAAgD,oCAAoC;AADpF;AAAA;;;AAEA,MAAM,UAAU,CAAA,GAAA,6LAAA,CAAA,aAAU,AAAD,EAAE;IACzB,MAAM;IACN,YAAY;IACZ,yFAAoD,MAAM;IAC1D,YAAY,6KAAA,CAAA,aAAU,CAAC,SAAS;IAChC,UAAU,gFAA6B,OAAO,CAAC,gBAAgB;IAC/D,YAAY;IACZ,eAAe;AACjB;uCACe"}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 155, "column": 0}, "map": {"version":3,"sources":["file://D%3A/shopify_new/my-app/src/app/api/auth/callback/route.js"],"sourcesContent":["// src\\app\\api\\auth\\callback\\route.js\r\nimport shopify from \"@/app/lib/shopify\";\r\nimport { cookies } from \"next/headers\";\r\nimport { NextRequest, NextResponse } from \"next/server\";\r\nimport { MongoClient } from \"mongodb\";\r\nconst MONGO_URI = process.env.MONGO_URI;\r\nconst client = new MongoClient(MONGO_URI);\r\nexport async function GET(req, res) {\r\n  if (req.method !== \"GET\") {\r\n    return NextResponse.json({ error: \"Method Not Allowed\" }, { status: 405 });\r\n  }\r\n  try {\r\n    const { session } = await shopify.auth.callback({\r\n      rawRequest: req,\r\n      rawResponse: res,\r\n    });\r\n    console.log(\"Session received:\", session);\r\n    if (!session?.shop || !session?.accessToken) {\r\n      throw new Error(\"Session missing required fields (shop, accessToken)\");\r\n    }\r\n    // ‚úÖ Connect to MongoDB\r\n    await client.connect();\r\n    const database = client.db(\"shopifyapp\");\r\n    const sessions = database.collection(\"sessions\");\r\n    // ‚úÖ Extract session data\r\n    const { shop, accessToken, scope, isOnline, expires } = session;\r\n    const sessionData = {\r\n      shop,\r\n      accessToken,\r\n      scope,\r\n      isOnline,\r\n      expires,\r\n      createdAt: new Date(),\r\n    };\r\n    // ‚úÖ Upsert session into MongoDB\r\n    const existingShop = await sessions.findOne({ shop });\r\n    if (existingShop) {\r\n      console.log(`Shop ${shop} already exists. Skipping session creation.`);\r\n    } else {\r\n      // ‚úÖ Upsert session into MongoDB if shop doesn't exist\r\n      await sessions.insertOne(sessionData);\r\n      console.log(\"‚úÖ Session saved successfully:\", sessionData);\r\n    }\r\n    // ‚úÖ Redirect to About page with necessary params\r\n    const { searchParams } = new URL(req.url);\r\n    const host = searchParams.get(\"host\");\r\n    // Ensure NEXT_PUBLIC_HOST does not include the protocol\r\n    const hostWithoutProtocol = process.env.NEXT_PUBLIC_HOST.replace(/^https?:\\/\\//, '');\r\n    const redirectUrl = `https://${hostWithoutProtocol}/products?host=${host}&shop=${session.shop}`;\r\n    console.log(\"üîπ Redirecting to:\", redirectUrl);\r\n    return NextResponse.redirect(redirectUrl);\r\n  } catch (error) {\r\n    console.error(\"‚ùå Error during OAuth callback:\", error);\r\n    return NextResponse.json(\r\n      { error: \"Authentication failed\", details: error.message },\r\n      { status: 500 }\r\n    );\r\n  } finally {\r\n    await client.close();\r\n  }\r\n}"],"names":[],"mappings":"AAAA,qCAAqC;;;;AACrC;AACA;AACA;AACA;;;;;AACA,MAAM,YAAY,QAAQ,GAAG,CAAC,SAAS;AACvC,MAAM,SAAS,IAAI,uGAAA,CAAA,cAAW,CAAC;AACxB,eAAe,IAAI,GAAG,EAAE,GAAG;IAChC,IAAI,IAAI,MAAM,KAAK,OAAO;QACxB,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAqB,GAAG;YAAE,QAAQ;QAAI;IAC1E;IACA,IAAI;QACF,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,8HAAA,CAAA,UAAO,CAAC,IAAI,CAAC,QAAQ,CAAC;YAC9C,YAAY;YACZ,aAAa;QACf;QACA,QAAQ,GAAG,CAAC,qBAAqB;QACjC,IAAI,CAAC,SAAS,QAAQ,CAAC,SAAS,aAAa;YAC3C,MAAM,IAAI,MAAM;QAClB;QACA,uBAAuB;QACvB,MAAM,OAAO,OAAO;QACpB,MAAM,WAAW,OAAO,EAAE,CAAC;QAC3B,MAAM,WAAW,SAAS,UAAU,CAAC;QACrC,yBAAyB;QACzB,MAAM,EAAE,IAAI,EAAE,WAAW,EAAE,KAAK,EAAE,QAAQ,EAAE,OAAO,EAAE,GAAG;QACxD,MAAM,cAAc;YAClB;YACA;YACA;YACA;YACA;YACA,WAAW,IAAI;QACjB;QACA,gCAAgC;QAChC,MAAM,eAAe,MAAM,SAAS,OAAO,CAAC;YAAE;QAAK;QACnD,IAAI,cAAc;YAChB,QAAQ,GAAG,CAAC,CAAC,KAAK,EAAE,KAAK,2CAA2C,CAAC;QACvE,OAAO;YACL,sDAAsD;YACtD,MAAM,SAAS,SAAS,CAAC;YACzB,QAAQ,GAAG,CAAC,iCAAiC;QAC/C;QACA,iDAAiD;QACjD,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,IAAI,GAAG;QACxC,MAAM,OAAO,aAAa,GAAG,CAAC;QAC9B,wDAAwD;QACxD,MAAM,sBAAsB,gFAA6B,OAAO,CAAC,gBAAgB;QACjF,MAAM,cAAc,CAAC,QAAQ,EAAE,oBAAoB,eAAe,EAAE,KAAK,MAAM,EAAE,QAAQ,IAAI,EAAE;QAC/F,QAAQ,GAAG,CAAC,sBAAsB;QAClC,OAAO,gIAAA,CAAA,eAAY,CAAC,QAAQ,CAAC;IAC/B,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,kCAAkC;QAChD,OAAO,gIAAA,CAAA,eAAY,CAAC,IAAI,CACtB;YAAE,OAAO;YAAyB,SAAS,MAAM,OAAO;QAAC,GACzD;YAAE,QAAQ;QAAI;IAElB,SAAU;QACR,MAAM,OAAO,KAAK;IACpB;AACF"}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}